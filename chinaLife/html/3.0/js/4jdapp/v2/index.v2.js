function priceInfo(){if(""!=skuidsv&&null!=skuidsv){var a=new Array;a=skuidsv.split(",");for(var b=a.length,c="",d=0;b>d;d++)c+=","+a[d];var e=c.substring(1,c.length),f={skuids:e,type:1,origin:2};$.ajax({url:"//pm.3.cn/prices/mgets?callback=callBackPriceService",data:f,method:"get",dataType:"jsonp"})}}function callBackPriceService(a){for(var b=0;b<a.length;b++){var c="",d="";a[b].p>0?(c=formatPrice(a[b].p),d=formatPrice(a[b].m)):c="暂无价格";var e=a[b].id.split("_");if(1==e.length){var f=e[0],g="goodItem_"+f,h=$("span[id='jd_price_"+f+"']"),i=$("span[id='old_price_"+f+"']"),j=$("div[id='"+g+"']");if("暂无价格"==c){for(var k=0;k<j.length;k++)$(j[k]).append("<span class='layer yahei'>已抢光<br><span class='arial en'>SOLDOUT</span></span>");for(var k=0;k<h.length;k++)$(h[k]).text("已下架")}else for(var k=0;k<h.length;k++)$(h[k]).html("<span class='rmb_ico'>¥</span><span>"+c+"</span>"),$(i[k]).html("<span class='rmb_ico'>¥</span><span>"+d+"</span>")}}}function getStockInfo(){""!=skuidsv&&null!=skuidsv&&$.ajax({type:"post",url:"/sg4jdappjson/checkStockBySkuids.html",data:{skuids:skuidsv},dataType:"json",success:function(a){if(a)for(var b in a)if(b&&"stockSoldOutList"==b&&a[b]&&a[b].length>0)for(var c=a[b],d=0,e=c.length;e>d;d++)for(var f=c[d],g="goodItem_"+f,h=$("div[id='"+g+"']"),i=0;i<h.length;i++)$(h[i]).append("<span class='layer yahei'>已抢光<br><span class='arial en'>SOLDOUT</span></span>")}})}function formatPrice(a){var b=a.split(".");return 2==b.length?"00"==b[1]?b[0]:b[1].indexOf("0")==b[1].length-1?a.substring(0,a.length-1):a:a}function loadActList(){$(".ending").hide(),$(".loading").show(),$.ajax({type:"post",url:"/sg4jdapp/actList.html",data:{vs:$("#vs").val(),sid:$("#sid").val()},dataType:"html",success:function(a){$(".brand_list").append(a),$(".ending").show(),$(".loading").hide(),$.each($(".logo"),function(a,b){$(this).attr("src",brandOccupiedImg)}),$.each($(".cover"),function(a,b){$(this).attr("src",actOccupiedImg)}),panda(function(a){switchCompressionRatio(),panda.widget.manager.get(a("widget.ResponseLazyLoad"),{target:panda(".brand_list img[srcset]")})})}})}function toFinal(a){$(".mod_slider").remove(),$(".J_tabitem").empty(),$.ajax({type:"post",url:"/sg4jdapp/finalSale.html",data:{vs:$("#vs").val(),sid:$("#sid").val()},dataType:"html",success:function(a){$(".J_tabitem").html(a),$.each($(".brand"),function(a,b){$(this).attr("src",brandOccupiedImg)}),$.each($(".cover"),function(a,b){$(this).attr("src",actOccupiedImg)}),panda(function(a){switchCompressionRatio()})}})}function toForeshow(a){$(".mod_slider").remove(),$(".J_tabitem").empty(),$.ajax({type:"post",url:"/sg4jdapp/foreshow.html",data:{vs:$("#vs").val(),sid:$("#sid").val()},dataType:"html",success:function(a){$(".J_tabitem").html(a),$.each($(".brand"),function(a,b){$(this).attr("src",brandOccupiedImg)}),$.each($(".cover"),function(a,b){$(this).attr("src",forecastOccupiedImg)}),panda(function(a){switchCompressionRatio()})}})}function showTypeAct(a,b){$(".mod_slider").remove(),$(".J_tabitem").empty(),$.ajax({type:"post",url:"/sg4jdapp/typeActList.html",data:{cid:a,vs:$("#vs").val(),sid:$("#sid").val()},dataType:"html",success:function(a){$(".J_tabitem").html(a),$.each($(".J_tabitem .cover"),function(a,b){$(this).attr("src",actOccupiedImg)}),panda(function(a){switchCompressionRatio()})}})}function handleTabs(){var a,b,c,d,e={},f=[],g=$(".tabs-wp .tab-bd");initTabs(),g.on("touchstart",function(b){var c=new Date;a=c.getTime(),void 0==tran&&(tran=0),e.startX=b.touches[0].clientX,e.endX=b.touches[0].clientX,e.prevX=e.startX,e.prevY=b.touches[0].clientY}).on("touchmove",function(a){g.css({"-moz-transition":"none","-webkit-transition":"none","-o-transition":"none","-ms-transition":"none",transition:"none"}),e.endX=a.touches[0].clientX,e.deltaX=a.touches[0].clientX-e.startX+tran,e.directionX=a.touches[0].clientX-e.prevX>0?"right":"left",e.directionY=a.touches[0].clientY-e.prevY>0?"bottom":"top",("top"==e.directionY||"bottom"==e.directionY)&&a.preventDefault();var b=-1*$(".tabs-wp .tab-bd").width(),d=$(".tabs-wp .tab-bd").parent().width();if(c=Math.sqrt(Math.pow(Math.abs(e.deltaX),2)),e.deltaX>0)g.css({transform:"translate("+e.deltaX/2+"px, 0px)","-ms-transform":"translate("+e.deltaX/2+"px, 0px)","-moz-transform":"translate("+e.deltaX/2+"px, 0px)","-webkit-transform":"translate("+e.deltaX/2+"px, 0px)","-o-transform":"translate("+e.deltaX/2+"px, 0px)"});else if(e.deltaX-d<b){var f=b+d,h=e.deltaX-(e.deltaX-f)/2;g.css({transform:"translate("+h+"px, 0px)","-ms-transform":"translate("+h+"px, 0px)","-moz-transform":"translate("+h+"px, 0px)","-webkit-transform":"translate("+h+"px, 0px)","-o-transform":"translate("+h+"px, 0px)"})}else g.css({transform:"translate("+e.deltaX+"px, 0px)","-ms-transform":"translate("+e.deltaX+"px, 0px)","-moz-transform":"translate("+e.deltaX+"px, 0px)","-webkit-transform":"translate("+e.deltaX+"px, 0px)","-o-transform":"translate("+e.deltaX+"px, 0px)"})}).on("touchend",function(c){d=Math.sqrt(Math.pow(Math.abs(e.endX-e.startX),2));var h=new Date;b=h.getTime();var i=b-a,j=0;d&&(j=d/i);var k,l=e.deltaX;j>.3?(j+=4,k=d*j,"right"==e.directionX?(l=e.deltaX+k,g.css({"-moz-transition":"-moz-transform 0.5625s cubic-bezier(0.33, 0.66, 0.66, 1) 0s","-webkit-transition":"-webkit-transform 0.5625s cubic-bezier(0.33, 0.66, 0.66, 1) 0s","-o-transition":"-o-transform 0.5625s cubic-bezier(0.33, 0.66, 0.66, 1) 0s","-ms-transition":"-ms-transform 0.5625s cubic-bezier(0.33, 0.66, 0.66, 1) 0s",transition:"transform 0.5625s cubic-bezier(0.33, 0.66, 0.66, 1) 0s"}).css({transform:"translate("+l+"px, 0px)","-ms-transform":"translate("+l+"px, 0px)","-moz-transform":"translate("+l+"px, 0px)","-webkit-transform":"translate("+l+"px, 0px)","-o-transform":"translate("+l+"px, 0px)"}),e.deltaX=_bounce(l,c)):"left"==e.directionX&&(l=e.deltaX-k,g.css({"-moz-transition":"-moz-transform 0.5625s cubic-bezier(0.33, 0.66, 0.66, 1) 0s","-webkit-transition":"-webkit-transform 0.5625s cubic-bezier(0.33, 0.66, 0.66, 1) 0s","-o-transition":"-o-transform 0.5625s cubic-bezier(0.33, 0.66, 0.66, 1) 0s","-ms-transition":"-ms-transform 0.5625s cubic-bezier(0.33, 0.66, 0.66, 1) 0s",transition:"transform 0.5625s cubic-bezier(0.33, 0.66, 0.66, 1) 0s"}).css({transform:"translate("+l+"px, 0px)","-ms-transform":"translate("+l+"px, 0px)","-moz-transform":"translate("+l+"px, 0px)","-webkit-transform":"translate("+l+"px, 0px)","-o-transform":"translate("+l+"px, 0px)"}),e.deltaX=_bounce(l,c))):e.deltaX=_bounce(l,c),tran=e.deltaX,f=[]}),g.find(".tab").on("tap",function(a){})}function _bounce(a,b){var c=-1*$(".tabs-wp .tab-bd").width(),d=$(".tabs-wp .tab-bd").parent().width();if(a>0)return $(".tabs-wp .tab-bd").css({"-moz-transition":"-moz-transform 0.5625s cubic-bezier(0.33, 0.66, 0.66, 1) 0s","-webkit-transition":"-webkit-transform 0.5625s cubic-bezier(0.33, 0.66, 0.66, 1) 0s","-o-transition":"-o-transform 0.5625s cubic-bezier(0.33, 0.66, 0.66, 1) 0s","-ms-transition":"-ms-transform 0.5625s cubic-bezier(0.33, 0.66, 0.66, 1) 0s",transition:"transform 0.5625s cubic-bezier(0.33, 0.66, 0.66, 1) 0s"}).css({transform:"translate(0px, 0px)","-ms-transform":"translate(0px, 0px)","-moz-transform":"translate(0px, 0px)","-webkit-transform":"translate(0px, 0px)","-o-transform":"translate(0px, 0px)"}),0;if(c>a-d){var e=c+d;return $(".tabs-wp .tab-bd").css({"-moz-transition":"-moz-transform 0.5625s cubic-bezier(0.33, 0.66, 0.66, 1) 0s","-webkit-transition":"-webkit-transform 0.5625s cubic-bezier(0.33, 0.66, 0.66, 1) 0s","-o-transition":"-o-transform 0.5625s cubic-bezier(0.33, 0.66, 0.66, 1) 0s","-ms-transition":"-ms-transform 0.5625s cubic-bezier(0.33, 0.66, 0.66, 1) 0s",transition:"transform 0.5625s cubic-bezier(0.33, 0.66, 0.66, 1) 0s"}).css({transform:"translate("+e+"px, 0px)","-ms-transform":"translate("+e+"px, 0px)","-moz-transform":"translate("+e+"px, 0px)","-webkit-transform":"translate("+e+"px, 0px)","-o-transform":"translate("+e+"px, 0px)"}),e}return a}function initTabs(){var a=$(".tabs-wp .tab-bd");$(".tab-new").hasClass("active")&&$(".tabs-wp .tab-bd").css("visibility","visible"),a.children().each(function(){if($(this).hasClass("active")){var a=$(this).offset().left,b=a-$(".tabs-wp .tab-new").width(),c=b-$(".tabs-wp .tab-cnt").width()/2+$(this).width()/2,d=-1*c,e=-1*$(".tabs-wp .tab-bd").width(),f=$(".tabs-wp .tab-bd").parent().width();d>0&&(d=0),e>d-f&&(d=e+f),$(".tabs-wp .tab-bd").css({transform:"translate("+d+"px, 0px)","-ms-transform":"translate("+d+"px, 0px)","-moz-transform":"translate("+d+"px, 0px)","-webkit-transform":"translate("+d+"px, 0px)","-o-transform":"translate("+d+"px, 0px)"}),tran=d,$(".tabs-wp .tab-bd").css("visibility","visible")}})}var brandOccupiedImg="",actOccupiedImg=getActOccupiedImg(),forecastOccupiedImg=getForecastOccupiedImg();!function(){$.each($(".cover"),function(a,b){a>2&&$(this).attr("src",actOccupiedImg)})}();var pageModle={config:{index:1,url:null,oldUrl:null},init:function(){var a=this;a.config.oldUrl=location.href,a.refer=location.referer,a.handle()},handle:function(){var a=this;$(".event_list .banner_info").on("click",function(b){if(b.preventDefault(b),a.config.url=$(this).attr("href"),a.showPage(a.config.url),b&&/\d/.test(b.button)){var c=location.href,d={refer:c},e="22",f=a.config.url;history.pushState(d,e,f)}}),$(window).bind("popstate",function(b){b.state&&console.log("refer:"+b.state.refer),1===a.config.index?a.showPage(a.config.url):a.config.index>1&&a.removePage(a.config.oldUrl)})},showPage:function(a){var b=this;$(".header").addClass("hide"),$(".content-wp").addClass("hide"),b.config.index+=1;var c=$('<div class="cj-page"></div>');$(".content-wp").after(c)},removePage:function(a){var b=this;$(".header").removeClass("hide"),$(".content-wp").removeClass("hide");var c=a,d={refer:c},e="22",f=a;window.history.replaceState(d,e,f),$(".cj-page").remove(),b.config.index-=1}};$(function(){function a(a){o=a.touches[0].clientX,p=a.touches[0].clientY,m=o}function b(a){var b=(a.touches,a.touches[0].clientX),c=a.touches[0].clientY;if(!(Math.abs(c-p)>Math.abs(b-o))){a.preventDefault(),n=b;var d=Math.abs(b-o),e=$("#idSlider").css("left").replace("px","");o>b?(h.Stop(),$("#idSlider").css("left",parseInt(e)-d+"px")):(h.Stop(),$("#idSlider").css("left",parseInt(e)+d+"px")),o=b}}function c(a){0!=n&&(m>n?d(m,n):n>m&&d(m,n),m=0,n=0)}function d(a,b){a>=b?h.Next():h.Previous()}handleTabs(),loadJdHeadAndFooter();var e=$("#idSlider").find(".item"),f=e.length;if($("#idSlider").css("width",100*f+"%"),f>1){var g=function(a,b){for(var c=0,d=a.length;d>c;c++)b.call(this,a[c],c)},h=createPicMove("idContainer","idSlider",f),i=[];document.getElementById("idNum").innerHTML="";for(var j=0,k=h._count-1;k>=j;j++){var l=document.createElement("li");l.className="cur",i[j]=document.getElementById("idNum").appendChild(l)}h.onStart=function(){g(i,function(a,b){h.Index==i.length&&0==b?a.className="cur":a.className=h.Index==b?"cur":""})},$("#idSlider").css("position","relative");var m=0,n=0,o=0,p=0,q=document.getElementById("idContainer");q.addEventListener("touchstart",a,!1),q.addEventListener("touchmove",b,!1),q.addEventListener("touchend",c,!1),h.Run(),window.screenSize=null;var r=function(){if(window.screenSize!=$("#idContainer").width()){window.screenSize=$("#idContainer").width(),h.Stop();var a=$("#idContainer").width();(h.Index-1)%h._count;$("#idSlider li").css("width",a+"px"),$("#idSlider").css("left",0),h.Change=a,h.Run()}};window.addEventListener("resize",r),window.addEventListener("orientationchange",r),r()}var s=function(a,b,c,d){var e=$("."+a),f=function(){e.each(function(a){var e=$(this),f=0,h=0,i=0,j=0,k=Math.floor(c),l=0,m=e.find("."+b),n="",o=e.find("ul"),p=o.find("li");if(1==p.length?p.eq(0).children("div").addClass("curr"):(d&&o.append(o.find("li").clone()),p=o.find("li"),f=p.length,d||f%k==0||(f=k*Math.ceil(f/k))),f>1){i=Math.ceil(e.width()/c),j=Math.ceil((i+1)*f),d?(l=-i*f/2,h=Math.ceil(f/2/k)):h=Math.ceil(f/k),1==k&&c/k!=1&&(l+=i*(c-1)/2,d?p.eq(f/2).children("div").addClass("curr"):p.eq(0).children("div").addClass("curr")),o.css({width:j+"px","-webkit-Transform":"translate3d("+l+"px,0px,0px)",transition:"all 0ms ease-out"}),p.css({width:i+"px"});for(var q=0;h>q;q++)n+=0==q?'<li class="curr"></li>':"<li></li>";m.html(n),g(o,m,i,h,f,k)}}).removeClass(a)},g=function(a,b,e,f,g,h){function i(b){l=b.touches[0].pageX,m=b.touches[0].pageY,p=!1,q=!1,r=0,a.css("transition","0ms")}function j(b){if(r=b.touches[0].pageX-l,p||(q=Math.abs(r)<Math.abs(b.touches[0].pageY-m),p=!0),!q){b.stopPropagation(),b.preventDefault();var f=r-n*e;1==h&&c/h!=1&&(f=r-n*e+e*(c-1)/2),!d&&0==n&&r>0||!d&&n==g-h&&0>r||a.css({"-webkit-Transform":"translate3d("+f+"px,0,0)"})}}function k(a){if(!q){var b=40,c=-b>=r?1:r>b?-1:0;s(n+c*h)}}var l=0,m=0,n=0,o=500,p=!1,q=!1,r=0;d&&(n=g/2),a.bind("touchstart",i),a.bind("touchmove",j),a.bind("touchend",k);var s=function(i){function j(){var d=-e*i,g=i/h-f;h/c!=1&&(d+=e*(c-1)/2,g=i-f),b.find("li").removeClass("curr").eq(g).addClass("curr"),a.find("li").children("div").removeClass("curr").eq(i).addClass("curr"),a.css({transition:o+"ms ease-out","-webkit-Transform":"translate3d("+d+"px,0px,0px)"}),n=i}if(f>1)if(d)i>=g-h?(i=g/2-h,a.css({transition:"0ms","-webkit-Transform":"translate3d(-"+e*(g/2-2*h)+"px,0px,0px)"}),setTimeout(j,20)):1>i?(i=g/2,a.css({transition:"0ms","-webkit-Transform":"translate3d(-"+e*(g/2+h)+"px,0px,0px)"}),setTimeout(j,20)):j();else{if(i>=g||0>i)return;j()}}};f()};s("j-focus","pagi",3),priceInfo(),getStockInfo()});var tran,filterClose=null,filter=$("#J_filter"),tab=$("#J_tab"),sortRes=$("#J_sortRes"),tabContent=$(".J_tabitem"),preItem=null;filter.on("click",".item",function(){var a=$(this),b=a.text();return a.addClass("on").siblings().removeClass("on"),sortRes.text(b),clearTimeout(filterClose),filterClose=setTimeout(function(){filter.removeClass("show")},1e3),preItem=null,!1});var tablength=tab.children(".item").length;tab.on("click",".item",function(){var a=$(this),b=a.index();return b==tablength-1?void(filter.hasClass("show")?(filter.removeClass("show"),"分类"==sortRes.text()&&(a.removeClass("on"),preItem&&preItem.addClass("on"))):(preItem=a.siblings(".on"),a.addClass("on").siblings().removeClass("on"),filter.addClass("show"))):(sortRes.text("分类"),filter.children(".item").removeClass("on"),filter.removeClass("show"),a.addClass("on").siblings().removeClass("on"),void 0)});